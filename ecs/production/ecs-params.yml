version: 1
task_definition:
  ecs_network_mode: bridge
  task_execution_role: auto-delivery-system_ecs
  task_size:
    cpu_limit: 512
    mem_limit: 512

  services:
    app:
      # System Managerのパラメーターストアから値を取得して環境変数にセット
      # 予め設定をしておく必要がある
      # ECSのマネジメントコンソールには環境変数名(TOKEN)とパラメーターキー(token_for_test)が表示される
      mem_reservation: 256m
      secrets:
        - value_from: token_for_test
          name: TOKEN

    web:
      # System Managerのパラメーターストアから値を取得して環境変数にセット
      # 予め設定をしておく必要がある
      # ECSのマネジメントコンソールには環境変数名(TOKEN)とパラメーターキー(token_for_test)が表示される
      mem_reservation: 256m
      secrets:
        - value_from: token_for_test
          name: TOKEN

run_params:
  network_configuration:
    awsvpc_configuration:
      subnets:
        - 542b8e7f
      security_groups:
        - sg-067bac5287b13ae17
      assign_public_ip: ENABLED